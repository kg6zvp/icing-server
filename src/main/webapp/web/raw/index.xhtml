<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:of="http://omnifaces.org/functions"
	xmlns:prettyfaces="http://ocpsoft.com/prettyfaces" >
	
	<h:head>
		<title>#{rawPage.title}</title>
		
		<script type="text/javascript">
			function toggleFullscreen(player){
				if(player.fullScreen||player.webkitDisplayingFullscreen || player.mozFullScreen){
					document.cancelFullScreen();
					//alert('You are now windowed');
				}else{
					if(player.requestFullScreen){
						player.requestFullScreen();
					}else if(player.webkitRequestFullScreen){
						player.webkitRequestFullScreen();
					}else if(player.mozRequestFullScreen){
						player.mozRequestFullScreen();
					}else{
						//boo hoo
					}
					//alert('You are now fullscreen');
				}
			}
		
			function playPause(player){
				if(player.paused){
					player.play();
				}else{
					player.pause();
				}
			}
			
			let player;
			
			function keypress(event){
				switch(event.keyCode){
					case 32: //spacebar
						playPause(player);
						break;
					case 72: //h
					case 104:
						player.currentTime = player.currentTime-15;
						break;
					case 76: //l
					case 108:
						player.currentTime = player.currentTime+15;
						break;
					default:
						console.log(event.keyCode);
				}
				player.setAttribute("controls","controls");
			}
			
			function initPage(){
				player = document.getElementById('movie');
				document.cancelFullScreen = document.webkitExitFullscreen || document.mozCancelFullScreen || document.exitFullscreen;
				document.body.onkeypress = keypress;
			}
		</script>
		
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	</h:head>
	
	<h:body onload="initPage()">
		<div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);">
			<p:panel header="#{rawPage.getTitle()}" styleClass="ui-noborder">
				<video onclick="playPause(this)" ondblclick="toggleFullscreen(this)" id="movie" src="#{rawPage.getUrl()}" type="#{rawPage.getMimeType()}"
					width="100%" height="auto" preload='metadata' controls='' autoplay='' autofocus=''>
				</video>
			</p:panel>
		</div>
	</h:body>
</html>
